<html>
   <head>
       <meta charset="UTF-8"/>
       <title>try try see</title>
       <link href="style.css" rel="stylesheet">
       <script src="phaser.min.js"></script>
       <script src="jquery-2.2.0.min.js"></script>
   </head>
   <body>
       <div class="container">
         <div class="gameview"id="tts"></div>
         <div class="question-block">
           <div class="question-text">
             我是題目，我也是題目，還是題目。我是題目，我也是題目，還是題目。我是題目，我也是題目，還是題目。我是題目，我也是題目，還是題目。我是題目，我也是題目，還是題目。我是題目，我也是題目，還是題目。我是題目，我也是題目，還是題目。
           </div>
         </div>
       </div>

       <script lang="javascript">
       // var gameWidth = 1000;
       var gameHeight = 800;
       var gameWidth = Math.floor($(document).width() * 0.7 -5 );
       // var gameHeight = Math.floor($(document).height() - 5);

        // phaserCreate the game object itself
        var game = new Phaser.Game(
            gameWidth,    gameHeight,                   // 800 x 600 rebackgroundolution.
           Phaser.AUTO,                   // Allow Phaser to determine Canvas or WebGL
           "tts",                   // The HTML element ID we will connect Phaser to.
           {                               // Functions (callbacks) for Phaser to call in
               preload: phaserPreload,     // in different states of its execution
               create: phaserCreate,
               update: phaserUpdate,
               render: phaserRender
           }
        );

        function phaserPreload() {
          game.load.image('zombie', 'zombie.gif');
        }

        var zombieGroup;
        var walkingZombies = [];
        function phaserCreate() {
          game.physics.startSystem(Phaser.Physics.ARCADE);

          zombieGroup = game.add.group();
          zombieGroup.enableBody = true;
          zombieGroup.createMultiple(10, 'zombie');
          zombieGroup.setAll('anchor.x', 0);
          zombieGroup.setAll('anchor.y', 0);
          zombieGroup.setAll('outOfBoundsKill', true);

          game.time.events.loop(Phaser.Timer.SECOND * 2, zombieRising, this);
          //zombieRising();
        }

        function zombieRising() {
          var zombie = zombieGroup.getFirstExists(false);
          if(zombie === null) {
            return;
          }
          var x  =  game.rnd.integerInRange(game.world.width * 0.15,
                                              game.world.width * 0.4);
          zombie.reset(x, 15);
          zombie.scale.setTo(0.2,0.2);
          walkingZombies.push(zombie);
          zombieGroup.sendToBack(zombie);
          zombie.body.velocity.y = 4;
          zombie.body.acceleration.y = 1.5;
          zombie.body.velocity.x = -1 * game.rnd.integerInRange(18, 40);
          zombie.body.acceleration.x = -1 * game.rnd.realInRange(2.0, 4.6);
          if(x >= game.world.width *0.3) {
            zombie.body.velocity.x = -1 * game.rnd.integerInRange(25, 55);
            zombie.body.acceleration.x = -1 * game.rnd.realInRange(3.5, 6.2);
          }
        }


        function phaserUpdate() {
          for(var i = 0; i <  walkingZombies.length; i++) {
            var zombie = walkingZombies[i];

            var newscale = zombie.y * 0.03;
            if(newscale >= 0.2) {
              zombie.scale.x = newscale;
              zombie.scale.y = newscale;
            }

            if(zombie.scale.x > 4) {
              zombie.kill();
              walkingZombies.slice(i, 1);
            }

          }

        }


        function phaserRender() {

          var foo = walkingZombies[0];
          if(foo !== undefined) {
            game.debug.bodyInfo(foo, 20, 32);
          }




        }

       </script>
   </body>
</html>
